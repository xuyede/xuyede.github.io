{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2019/04/03/tapable-SyncLoopHook/","webpackCompilationHash":"4e76112e90763e5c5515","result":{"data":{"markdownRemark":{"html":"<h1>å‰è¨€</h1>\n<p><strong>ç©<code class=\"language-text\">webpack</code>çš„éƒ½çŸ¥é“,<code class=\"language-text\">webpack</code>æŠŠå„ä¸ªæ’ä»¶ä¸²è”èµ·æ¥çš„æ ¸å¿ƒæ˜¯<code class=\"language-text\">tapable</code>,è€Œ<code class=\"language-text\">tapable</code>é‡Œé¢æœ‰å¾ˆå¤š<code class=\"language-text\">*hook</code>å‡½æ•°,å…¶ä¸­æœ‰ä¸€ä¸ªä¸å¸¸ç”¨,ä½†æ˜¯å´å¾ˆå¥½ç©çš„é’©å­å‡½æ•°å« <code class=\"language-text\">SyncLoopHook</code>, äºæ˜¯æˆ‘å°±è‡ªå·±å®ç°äº†ä¸€é, ç„¶åæƒ³å»å’Œç½‘å‹å¯¹æ¯”ä¸€ä¸‹å®ç°çš„ä¸åŒã€‚è°çŸ¥é“,ç½‘ä¸Šå¾ˆå¤š<code class=\"language-text\">SyncLoopHook</code>å‡½æ•°çš„å®ç°éƒ½æ˜¯ä¸€æ ·çš„,è€Œä¸”è¿˜æ˜¯é”™çš„ ğŸ˜±</strong></p>\n<h1>ç½‘ä¸Šæ™®éçš„SyncLoopHook ğŸ˜®</h1>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SyncLoopHook</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">tap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span>task</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>    \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">task</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> ret<span class=\"token operator\">=</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n                ret <span class=\"token operator\">=</span> <span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ç½‘ä¸Šå¤§éƒ¨åˆ†éƒ½æ˜¯è¿™æ ·å®ç°çš„, è¿™æ ·å†™åªæ˜¯æŠŠ<code class=\"language-text\">return</code>é<code class=\"language-text\">undefind</code>çš„å›è°ƒå‡½æ•°å¾ªç¯æ‰§è¡Œ</p>\n<hr>\n<p>å¦‚ä¸‹å›¾, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ‰§è¡Œäº†ä¸¤é,æ²¡é—®é¢˜</p>\n<p><a href=\"http://119.23.54.204/static/xyd_image/2019/04/03/1.png\"><img src=\"http://119.23.54.204/static/xyd_image/2019/04/03/1.png\"></a></p>\n<p>ä½†æ˜¯æŠŠ<code class=\"language-text\">return</code>æ”¾åˆ°ç¬¬äºŒä¸ªä¹‹åçš„å°±ä¼šå‡ºé”™äº†,å®ƒåªæ˜¯æŠŠç¬¬äºŒä¸ªå›è°ƒå‡½æ•°æ‰§è¡Œä¸¤æ¬¡</p>\n<p><a href=\"http://119.23.54.204/static/xyd_image/2019/04/03/2.png\"><img src=\"http://119.23.54.204/static/xyd_image/2019/04/03/2.png\"></a></p>\n<p>è€Œ<code class=\"language-text\">tapable</code>é‡Œçš„<code class=\"language-text\">SyncLoopHook</code>æ˜¯æŠŠåŒ…æ‹¬<code class=\"language-text\">return</code>é<code class=\"language-text\">undefined</code>çš„å›è°ƒå‡½æ•°å’Œè¯¥å›è°ƒå‡½æ•°ä¹‹å‰çš„å›è°ƒå‡½æ•°éƒ½å¾ªç¯ä¸€é, å¦‚ä¸‹å›¾</p>\n<p><a href=\"http://119.23.54.204/static/xyd_image/2019/04/03/3.png\"><img src=\"http://119.23.54.204/static/xyd_image/2019/04/03/3.png\"></a></p>\n<h1>æˆ‘çš„SyncLoopHook ğŸ˜¯</h1>\n<p>æ³¨æ„ : SyncLoopHookåªèƒ½æœ‰ä¸€æ¬¡å¾ªç¯, å¦‚æœä¸å¯¹, è¯·åŠæ—¶å‘Šè¯‰æˆ‘</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SyncLoopHook</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">tap</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">call</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> ret<span class=\"token punctuation\">,</span>\n            alreadyLoop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>  <span class=\"token comment\">// æ˜¯å¦å·²ç»å¾ªç¯äº†</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tasks<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">baton<span class=\"token punctuation\">,</span> task</span><span class=\"token punctuation\">)</span>  <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            baton<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span>\n            \n            <span class=\"token comment\">// åˆ¤æ–­æœ€æ–°ä¸€ä¸ªå›è°ƒå‡½æ•°çš„è¿”å›å€¼</span>\n            ret <span class=\"token operator\">=</span> baton<span class=\"token punctuation\">[</span>baton<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n            \n            <span class=\"token comment\">// å¦‚æœè¿”å›å€¼ä¸ºundefined ä¸” å¦‚æœå·²ç»å¾ªç¯äº†, è¿”å›[], å¦‚æœè¿˜æ²¡å¾ªç¯, è¿”å›åŒ…å«ä¸Šä¸€ä¸ªå›è°ƒçš„baton</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>ret<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> alreadyLoop <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> baton\n            \n            <span class=\"token comment\">// å¦‚æœä¸æ˜¯undefine,éå†batonå¹¶æ£€æµ‹æœ€åä¸€ä¸ªå›è°ƒå‡½æ•°çš„è¿”å›å€¼,ç›´åˆ°ä¸ºundefined</span>\n            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span> ret <span class=\"token operator\">=</span> baton<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">e</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            \n            <span class=\"token comment\">// ä»£ç æ‰§è¡Œåˆ°è¿™é‡Œ,è¯æ˜å·²ç»å¾ªç¯äº†</span>\n            alreadyLoop <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        \n            <span class=\"token comment\">// å·²ç»å¾ªç¯äº†,æ¸…ç©ºbaton</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><a href=\"http://119.23.54.204/static/xyd_image/2019/04/03/4.png\"><img src=\"http://119.23.54.204/static/xyd_image/2019/04/03/4.png\"></a></p>\n<p><a href=\"http://119.23.54.204/static/xyd_image/2019/04/03/5.png\"><img src=\"http://119.23.54.204/static/xyd_image/2019/04/03/5.png\"></a></p>\n<hr>\n<h1>æ€»ç»“</h1>\n<p>æœ‰æ—¶å€™ç½‘ä¸Šçš„ä¸œè¥¿ä¹Ÿä¸èƒ½å…¨ä¿¡,è¿˜æ˜¯è¦è‡ªå·±å†™ä¸€éæ‰è¡Œ~</p>","frontmatter":{"mainTitle":"çœŸå‡ SyncLoophook ğŸ’€","date":"03 April, 2019","cover_image":{"publicURL":"/static/webpack-362a5f580df72a6b4064d0c7d6b91811.jpg"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2019/04/03/tapable-SyncLoopHook/"}}}